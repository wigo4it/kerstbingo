<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Kwartaalmeeting zomer 2024</title>
	<link rel="stylesheet" href="game.css">
</head>

<style>
	.rotate {
		--animation-duration: 41500ms;
		--animation-divisor: 4;
	}
</style>

<body>
	<button id="button">Wie wint er een C02 meter?</button>
	<div id="textBox"></div>
	<canvas id="confetti"></canvas>
	<audio id="wachtMuziekje" src="wachtMuziekje.mp3" type="audio/mp3"></audio>
	<audio id="winnaar" src="winnaar.mp3" type="audio/mp3"></audio>
	<a href="https://brave-flower-0b3176903.5.azurestaticapps.net/game/index.html" class="background-link"></a>


	<script src="confetti.js"></script>

	<script>
		document.addEventListener('DOMContentLoaded', function () {
			const button = document.getElementById('button');
			const textBox = document.getElementById('textBox');
			let names = [];

			fetch('game.csv')
				.then(response => response.text())
				.then(data => {
					names = data.split(',');
					console.log(names);
				});
			// Function to handle the action
			function handleAction() {
				const self = button;
				textBox.classList.remove('final-name');
				self.classList.remove('rotate');
				void self.offsetWidth;
				self.classList.add('rotate');

				document.getElementById('wachtMuziekje').play();
				document.getElementById('confetti').style.display = 'none';
				let currentIndex = 0;
				const intervalTime = 400;
				const totalTime = 41500;

				const interval = setInterval(function () {
					if (names.length > 0) {
						textBox.textContent = names[currentIndex];
						currentIndex = (currentIndex + 1) % names.length;
					}
				}, intervalTime);

				setTimeout(function () {
					clearInterval(interval);
					if (names.length > 0) {
						const randomIndex = Math.floor(Math.random() * names.length);
						textBox.textContent = names[randomIndex]; // Display a random name
						textBox.classList.add('final-name');
						self.classList.remove('rotate');
					}
				}, totalTime);

				// Show the confetti and play sound after x seconds
				setTimeout(function () {
					document.getElementById('confetti').style.display = 'block';
					document.getElementById('winnaar').play();
				}, totalTime + 100); // Adjust time as needed
			}

			// Add event listener for the button click
			button.addEventListener('click', handleAction);

			// Add event listener for the Enter key press
			document.addEventListener('keydown', function (event) {
				if (event.key === 'Enter'|| event.key === ' ') {
					handleAction();
				}
			});

		});
	</script>
</body>

</html>